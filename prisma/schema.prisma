// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  directUrl = env("DIRECT_URL")
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum RoleUser {
  ADMIN @map("administrator")
  USER  @map("user")
}

model User {
  id                        Int         @default(autoincrement()) @id
  username                  String                                                                          @unique
  email                     String                                                                          @unique
  emailVerified             Boolean     @default(false)                 @map("email_verified")
  failedAttempts            Int         @default(0)                     @map("failed_attempts")
  lockoutUntil              DateTime?                                   @map("lock_out_until")
  password                  String
  resetPasswordToken        String?                                     @map("reset_password_token")        @unique
  resetPasswordTokenExpiry  DateTime?                                   @map("reset_password_token_expiry") @unique
  role                      RoleUser    @default(USER)
  twoFactorSecret           String?                                     @map("two_factor_secret")
  verificationToken         String?                                     @map("verification_token")          @unique
  createdAt                 DateTime    @default(now())                 @map("created_at")
  updatedAt                 DateTime                                    @map("updated_at")                              @updatedAt

  address                   Address?

  @@map("users")
}

model Address {
  id                        Int       @default(autoincrement()) @id
  street                    String?
  city                      String?
  province                  String
  country                   String
  postal_code               String

  user                      User     @relation(fields: [userId], references: [id])
  userId                    Int                                                                            @unique
}
